program matrixtest
   use slu
   implicit none

   integer, parameter :: rp=8, n=20, nnz=24
   real(kind=rp) :: rhs(n)

   real(kind=rp) :: val(nnz)
   integer :: colind(nnz), rowptr(n+1), ierr

   val = [ 1. , 0.66004251, 1. , 1. , 0.16580944, 1. , 1. , 1. , 1. , 1. , &
      0.48754192, 1. , 1. , 1. , 1. , 1. , 1. , 0.39321144, 1. , 1. , 1. , &
      1. , 1. , 1. ]
   colind = [ 0,  2,  1,  2, 15,  3,  4,  5,  6,  7,  1,  8,  9, 10, 11, 12, &
      13, 10, 14, 15, 16, 17, 18, 19] + 1
   rowptr = [0, 2, 3, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 19, 20, 21, &
      22, 23, 24] + 1

   rhs = [ 0.36505416,  0.87209716,  0.11306562,  0.15746164,  0.36074325, &
           0.95214683,  0.97631797,  0.26061262,  0.25675798,  0.75232693, &
           0.07135243,  0.07346062,  0.41943103,  0.48905309,  0.12271773, &
           0.88581534,  0.99626864,  0.6568508 ,  0.63238463,  0.65226356 ]

   call slu_solve(n, nnz, 1, 1, val, colind, rowptr, rhs, ierr)

   print*, 'rhs: ', rhs


end program
